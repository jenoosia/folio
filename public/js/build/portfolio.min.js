!function(a,b,c,d){function e(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a}function f(a){return!isNaN(parseFloat(a))&&isFinite(a)}a.albums,b(document).ready(function(){a.albums=new a.Albums,c.applyBindings(a.albums,document.getElementById("albums")),a.albums.run()}),a.galleryBase="albums",c.bindingHandlers.fadeVisible={init:function(a,d){var e=d();b(a).toggle(c.utils.unwrapObservable(e))},update:function(a,d){var e=d();c.utils.unwrapObservable(e)?b(a).fadeIn(800):b(a).hide()}},a.Albums=function(){var e=this;e.run=function(){var a=d.getState(),c=a.url.split("?");if(c.length<=1)return e.showGallery(),void 0;var f=c[1].split("&"),g={};if(b.each(f,function(a,b){var c=b.split("=");g[c[0]]=c.length>1?c[1]:null}),g.album){var h=e.dataMap[g.album];h?e.showAlbum(h,g.image):e.showGallery()}else e.showGallery()},d.Adapter.bind(window,"statechange",e.run),e.albums=c.observableArray([]),e.dataMap={},b.each(a.GalleryData,function(b,c){e.dataMap[c.id]=c,e.albums.push(new a.AlbumCover(e,c))}),e.isVisible=c.observable(!1),e.expandedAlbums={},e.currentAlbum=null,e.showAlbum=function(d,f){var g=d.id;if(null!=e.currentAlbum){if(e.currentAlbum.data.id==g)return;e.currentAlbum.isVisible(!1),e.currentAlbum=null}if(e.expandedAlbums[g])return e.currentAlbum=e.expandedAlbums[g],e.isVisible(!1),e.currentAlbum.isVisible(!0),e.currentAlbum.navigateToImage(f),void 0;var h=b("[data-template=album]").clone();h.removeAttr("data-template").attr("id",g),b("#albumPlaceholder").before(h);var i=new a.AlbumView(e,d);c.applyBindings(i,h[0]),i.initAlbum(h,f),e.currentAlbum=i,e.expandedAlbums[g]=e.currentAlbum,e.isVisible(!1)},e.showGallery=function(){null!=e.currentAlbum&&(e.currentAlbum.isVisible(!1),e.currentAlbum=null),e.isVisible(!0)},e.historyPush=function(a,b){d.pushState(null,b?b:"Portfolio - Jensen Ching Photography",a?"?album="+a:"?");try{ga("send","pageview")}catch(c){}}},a.AlbumCover=function(b,c){var d=this;d.parent=b,d.data=c,d.albumImage=a.galleryBase+"/"+c.folderThumbs+"/"+c.imagePrefix+a.GalleryConst.thumbMidfix+e(c.albumCover,4)+a.GalleryConst.defaultExt,d.showAlbum=function(){d.parent.historyPush(d.data.id,d.data.name+" - Jensen Ching Photography")}},a.AlbumView=function(e,g){var h=this;h.parent=e,h.data=g,h.$album=null,h.isVisible=c.observable(!1),h.hasLoaded=c.observable(!1),h.numLoaded=c.observable(0),h.loadingText=c.computed(function(){var a=Math.round(100*(h.numLoaded()/h.data.totalImages));return""+a+"%"}),h.photos=c.observableArray([]),h.goBack=function(){h.parent.historyPush()},h.lightOpen=!1,h.lightbox=null,h.navigateToImage=function(a){f(a)&&b("a[data-image-id="+a+"]").click()},h.initAlbum=function(a,c){$album=a,$album.imagesLoaded().done(function(){h.hasLoaded(!0),$album.find(".photos").masonry({itemSelector:".item",gutter:10}),h.lightbox=$album.find(".photos>.item>a").colorbox({rel:h.data.id,maxWidth:"95%",maxHeight:"95%",onComplete:function(){h.lightOpen=!0,d.pushState(null,h.data.name+" - Jensen Ching Photography","?album="+h.data.id+"&image="+b(this).attr("data-image-id"));try{ga("send","pageview")}catch(a){}},onClosed:function(){h.lightOpen=!1,d.pushState(null,h.data.name+" - Jensen Ching Photography","?album="+h.data.id)}}),h.navigateToImage(c)}).progress(function(){h.numLoaded(h.numLoaded()+1)}),h.isVisible(!0)};for(var i=1;i<=h.data.totalImages;i++)h.photos.push(new a.AlbumThumb(h,i))},a.AlbumThumb=function(b,c){var d=this;d.parent=b,d.theNumber=c,d.fullUrl=a.galleryBase+"/"+b.data.folderFull+"/"+b.data.imagePrefix+a.GalleryConst.fullMidfix+e(c,4)+a.GalleryConst.defaultExt,d.thumbUrl=a.galleryBase+"/"+b.data.folderThumbs+"/"+b.data.imagePrefix+a.GalleryConst.thumbMidfix+e(c,4)+a.GalleryConst.defaultExt}}(window.jnz=window.jnz||{},jQuery,ko,window.History);